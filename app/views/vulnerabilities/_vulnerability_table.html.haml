.vulnerabilities-filter
  = render partial: 'version_filter'
.vulnerabilities-datatable
  - if @vulnerabilities.present?
    %table.table.table-striped
      %thead
        %tr
          %th.col-md-1
            = t('vulnerabilities.index.cve_id')
            = render_sort_icon('cve_id')
          %th.col-md-1{ style: 'min-width: 95px;'}
            = t('vulnerabilities.index.severity')
            = render_sort_icon('severity')
          %th.col-md-2
            = t('vulnerabilities.index.date_published')
            = render_sort_icon('published_on')
          %th.col-md-5= t('vulnerabilities.index.description')
          %th.col-md-3= t('vulnerabilities.index.versions_affected')
      %tbody
        - @vulnerabilities.each do |vulnerability|
          %tr.nvd_link{ 'data-nvd-link' => (ENV['NVD_LINK'] + vulnerability.cve_id).to_s }
            %td= vulnerability.cve_id
            %td= vulnerability.severity.titleize
            %td= vulnerability.published_on.to_s(:mdy)
            %td.vul_description= vulnerability.description
            %td
              .versions_affected= vulnerability.recent_releases
    .text-center
      = will_paginate @vulnerabilities, params: { controller: 'vulnerabilities', action: 'filter' }
  - else
    .no_vulnerability= t('vulnerabilities.index.no_vulnerability')
