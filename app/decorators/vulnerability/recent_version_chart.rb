class Vulnerability::RecentVersionChart < Vulnerability::VersionChart
  def data
    super
    custom_chart_options
  end

  private

  def custom_chart_options
    @default_options[:exporting] = {}
    @default_options[:exporting][:enabled] = false
    @default_options
  end

  def vulnerabilities_count_by_severity(level)
    release_ids = @best_security_set.most_recent_releases.map(&:id)
    @best_security_set.release_history(release_ids).map { |r| r.attributes[level] }
  end
end
